import{c as g,r as de}from"./index-d4e5aba6.js";var H={},K={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getListFiles=t.getImage=t.getBase64=t.getAcceptTypeString=t.openFileDialog=void 0,t.openFileDialog=function(i){i.current&&i.current.click()},t.getAcceptTypeString=function(i,r){return i!=null&&i.length?i.map(function(l){return"."+l}).join(", "):r?"":"image/*"},t.getBase64=function(i){var r=new FileReader;return new Promise(function(l){r.addEventListener("load",function(){return l(String(r.result))}),r.readAsDataURL(i)})},t.getImage=function(i){var r=new Image;return new Promise(function(l){r.addEventListener("load",function(){return l(r)}),r.src=URL.createObjectURL(i)})},t.getListFiles=function(i,r){for(var l=[],s=0;s<i.length;s+=1)l.push(t.getBase64(i[s]));return Promise.all(l).then(function(e){var o=e.map(function(u,d){var n;return n={},n[r]=u,n.file=i[d],n});return o})}})(K);var W={},L={};Object.defineProperty(L,"__esModule",{value:!0});L.DEFAULT_DATA_URL_KEY=L.INIT_MAX_NUMBER=L.DEFAULT_NULL_INDEX=void 0;L.DEFAULT_NULL_INDEX=-1;L.INIT_MAX_NUMBER=1e3;L.DEFAULT_DATA_URL_KEY="dataURL";(function(t){var i=g&&g.__awaiter||function(e,o,u,d){function n(a){return a instanceof u?a:new u(function(h){h(a)})}return new(u||(u=Promise))(function(a,h){function p(y){try{f(d.next(y))}catch(_){h(_)}}function T(y){try{f(d.throw(y))}catch(_){h(_)}}function f(y){y.done?a(y.value):n(y.value).then(p,T)}f((d=d.apply(e,o||[])).next())})},r=g&&g.__generator||function(e,o){var u={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},d,n,a,h;return h={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function p(f){return function(y){return T([f,y])}}function T(f){if(d)throw new TypeError("Generator is already executing.");for(;u;)try{if(d=1,n&&(a=f[0]&2?n.return:f[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,f[1])).done)return a;switch(n=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return u.label++,{value:f[1],done:!1};case 5:u.label++,n=f[1],f=[0];continue;case 7:f=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){u=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){u.label=f[1];break}if(f[0]===6&&u.label<a[1]){u.label=a[1],a=f;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(f);break}a[2]&&u.ops.pop(),u.trys.pop();continue}f=o.call(e,u)}catch(y){f=[6,y],n=0}finally{d=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorValidation=t.isMaxNumberValid=t.isAcceptTypeValid=t.isMaxFileSizeValid=t.isImageValid=t.isResolutionValid=void 0;var l=L,s=K;t.isResolutionValid=function(e,o,u,d){if(u===void 0&&(u=0),d===void 0&&(d=1),!u||!d||!e.width||!e.height)return!0;switch(o){case"absolute":{if(e.width===u&&e.height===d)return!0;break}case"ratio":{var n=u/d;if(e.width/e.height===n)return!0;break}case"less":{if(e.width<=u&&e.height<=d)return!0;break}case"more":{if(e.width>=u&&e.height>=d)return!0;break}}return!1},t.isImageValid=function(e){return!!e.includes("image")},t.isMaxFileSizeValid=function(e,o){return o?e<=o:!0},t.isAcceptTypeValid=function(e,o){if(e&&e.length>0){var u=o.split(".").pop()||"";if(e.findIndex(function(d){return d.toLowerCase()===u.toLowerCase()})<0)return!1}return!0},t.isMaxNumberValid=function(e,o,u){if(o!==0&&!o)return!0;if(u===l.DEFAULT_NULL_INDEX){if(e<=o)return!0}else if(e<=o+1)return!0;return!1},t.getErrorValidation=function(e){var o=e.fileList,u=e.value,d=e.maxNumber,n=e.keyUpdate,a=e.acceptType,h=e.maxFileSize,p=e.resolutionType,T=e.resolutionWidth,f=e.resolutionHeight,y=e.allowNonImageType;return i(void 0,void 0,void 0,function(){var _,E,w,F,I;return r(this,function(m){switch(m.label){case 0:return _={},t.isMaxNumberValid(o.length+u.length,d,n)?[3,1]:(_.maxNumber=!0,[3,5]);case 1:E=0,m.label=2;case 2:return E<o.length?(w=o[E].file,w?!y&&!t.isImageValid(w.type)?(_.acceptType=!0,[3,5]):t.isAcceptTypeValid(a,w.name)?t.isMaxFileSizeValid(w.size,h)?p?[4,s.getImage(w)]:[3,4]:(_.maxFileSize=!0,[3,5]):(_.acceptType=!0,[3,5]):[3,4]):[3,5];case 3:if(F=m.sent(),I=t.isResolutionValid(F,p,T,f),!I)return _.resolution=!0,[3,5];m.label=4;case 4:return E+=1,[3,2];case 5:return Object.values(_).find(Boolean)?[2,_]:[2,null]}})})}})(W);var B=g&&g.__assign||function(){return B=Object.assign||function(t){for(var i,r=1,l=arguments.length;r<l;r++){i=arguments[r];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},B.apply(this,arguments)},ve=g&&g.__createBinding||(Object.create?function(t,i,r,l){l===void 0&&(l=r),Object.defineProperty(t,l,{enumerable:!0,get:function(){return i[r]}})}:function(t,i,r,l){l===void 0&&(l=r),t[l]=i[r]}),ge=g&&g.__setModuleDefault||(Object.create?function(t,i){Object.defineProperty(t,"default",{enumerable:!0,value:i})}:function(t,i){t.default=i}),he=g&&g.__importStar||function(t){if(t&&t.__esModule)return t;var i={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ve(i,t,r);return ge(i,t),i},j=g&&g.__awaiter||function(t,i,r,l){function s(e){return e instanceof r?e:new r(function(o){o(e)})}return new(r||(r=Promise))(function(e,o){function u(a){try{n(l.next(a))}catch(h){o(h)}}function d(a){try{n(l.throw(a))}catch(h){o(h)}}function n(a){a.done?e(a.value):s(a.value).then(u,d)}n((l=l.apply(t,i||[])).next())})},X=g&&g.__generator||function(t,i){var r={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},l,s,e,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(n){return function(a){return d([n,a])}}function d(n){if(l)throw new TypeError("Generator is already executing.");for(;r;)try{if(l=1,s&&(e=n[0]&2?s.return:n[0]?s.throw||((e=s.return)&&e.call(s),0):s.next)&&!(e=e.call(s,n[1])).done)return e;switch(s=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,s=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(e=r.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){r=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){r.label=n[1];break}if(n[0]===6&&r.label<e[1]){r.label=e[1],e=n;break}if(e&&r.label<e[2]){r.label=e[2],r.ops.push(n);break}e[2]&&r.ops.pop(),r.trys.pop();continue}n=i.call(t,r)}catch(a){n=[6,a],s=0}finally{l=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},C=g&&g.__spreadArrays||function(){for(var t=0,i=0,r=arguments.length;i<r;i++)t+=arguments[i].length;for(var l=Array(t),s=0,i=0;i<r;i++)for(var e=arguments[i],o=0,u=e.length;o<u;o++,s++)l[s]=e[o];return l};Object.defineProperty(H,"__esModule",{value:!0});var b=he(de),z=K,ye=W,D=L,_e=function(t){var i=t.value,r=i===void 0?[]:i,l=t.onChange,s=t.onError,e=t.children,o=t.dataURLKey,u=o===void 0?D.DEFAULT_DATA_URL_KEY:o,d=t.multiple,n=d===void 0?!1:d,a=t.maxNumber,h=a===void 0?D.INIT_MAX_NUMBER:a,p=t.acceptType,T=t.maxFileSize,f=t.resolutionWidth,y=t.resolutionHeight,_=t.resolutionType,E=t.inputProps,w=E===void 0?{}:E,F=t.allowNonImageType,I=F===void 0?!1:F,m=r||[],S=b.useRef(null),G=b.useState(D.DEFAULT_NULL_INDEX),A=G[0],M=G[1],Y=b.useState(null),q=Y[0],J=Y[1],Q=b.useState(!1),x=Q[0],O=Q[1],k=b.useCallback(function(){return z.openFileDialog(S)},[S]),ee=b.useCallback(function(){M(D.DEFAULT_NULL_INDEX),k()},[k]),te=b.useCallback(function(){l==null||l([])},[l]),ne=function(c){var v=C(m);Array.isArray(c)?c.forEach(function(U){v.splice(U,1)}):v.splice(c,1),l==null||l(v)},re=function(c){M(c),k()},ae=function(c){return j(void 0,void 0,void 0,function(){var v;return X(this,function(U){switch(U.label){case 0:return[4,ye.getErrorValidation({fileList:c,maxFileSize:T,maxNumber:h,acceptType:p,keyUpdate:A,resolutionType:_,resolutionWidth:f,resolutionHeight:y,value:m,allowNonImageType:I})];case 1:return v=U.sent(),v?(J(v),s==null||s(v,c),[2,!1]):(q&&J(null),[2,!0])}})})},Z=function(c){return j(void 0,void 0,void 0,function(){var v,U,N,R,$,V;return X(this,function(P){switch(P.label){case 0:return c?[4,z.getListFiles(c,u)]:[2];case 1:return v=P.sent(),v.length?[4,ae(v)]:[2];case 2:if(U=P.sent(),!U)return[2];if(R=[],A>D.DEFAULT_NULL_INDEX)$=v[0],N=C(m),N[A]=$,R.push(A);else if(n)for(N=C(m,v),V=m.length;V<N.length;V+=1)R.push(V);else N=[v[0]],R.push(0);return l==null||l(N,R),[2]}})})},ie=function(c){return j(void 0,void 0,void 0,function(){return X(this,function(v){switch(v.label){case 0:return[4,Z(c.target.files)];case 1:return v.sent(),A>D.DEFAULT_NULL_INDEX&&M(D.DEFAULT_NULL_INDEX),S.current&&(S.current.value=""),[2]}})})},ue=b.useMemo(function(){return z.getAcceptTypeString(p,I)},[p,I]),le=function(c){c.preventDefault(),c.stopPropagation()},oe=function(c){c.preventDefault(),c.stopPropagation(),c.dataTransfer.items&&c.dataTransfer.items.length>0&&O(!0)},fe=function(c){c.preventDefault(),c.stopPropagation(),O(!1)},ce=function(c){c.preventDefault(),c.stopPropagation(),O(!1),c.dataTransfer.files&&c.dataTransfer.files.length>0&&Z(c.dataTransfer.files)},se=function(c){c.preventDefault(),c.stopPropagation(),c.dataTransfer.clearData()};return b.default.createElement(b.default.Fragment,null,b.default.createElement("input",B({type:"file",accept:ue,ref:S,multiple:n&&A===D.DEFAULT_NULL_INDEX,onChange:ie,style:{display:"none"}},w)),e==null?void 0:e({imageList:m,onImageUpload:ee,onImageRemoveAll:te,onImageUpdate:re,onImageRemove:ne,errors:q,dragProps:{onDrop:ce,onDragEnter:oe,onDragLeave:fe,onDragOver:le,onDragStart:se},isDragging:x}))},me=H.default=_e;export{me as _};
